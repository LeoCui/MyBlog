---
title: 网络代理调研
date: 2017-11-11 15:33:33
tags: 
	- 代理
catagories: 计算机网络
---
超哥让我调研网络代理情况，网络代理大致分为以下几种：

* socks代理：会话层，不管上层协议是什么，只是负责盲转发。应用层内容不解析。
* http/https代理： 又称网页代理，是一个应用层的代理，典型的如fidder,charles,这种代理可以解析https的内容。这里以charles为例简单说一下它的原理：
	* charles打开之后，浏览器所有的请求都会被转发到charles来处理。手机抓包的时候需要保证手机和电脑在一台局域网内并且在手机上设置代理到电脑的8888端口，这是charles的默认端口，可以改，这样手机上的所有请求都会被转发到charles来处理
	* 默认情况下，charles只能解析http包，这样对https的包就会乱码，解决这个问题需要开启charles的ssl代理，然后443的端口也会被解析。charles解析https协议的原理如下：
		* 对ssl的握手信息，伪造一份目标网站的证书，这样就相当于一个中间人攻击，charles在客户端和服务端分别建立了2条https链接，2套不同的密钥。这样的问题就是怎么让证书通过认证，所以需要安装charles的一个根证书颁发机构rootCA,rootCA对每个域名动态签发一个证书。由于rootCA被客户端信任(手动),所以rootCA颁发的证书也都被信任。
	
* 建立多个网站的镜像，这也是http/https的代理，比如zmirror